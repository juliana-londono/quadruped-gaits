%script to plot isolated (NOT induced) gaits.
% simulates isolated quadruped gaits (bound, pace, trot, walk, pronk), 
% reproduces Fig 3D,E (bound, walk).
%written by Juliana L

close all
clear all
addpath('functions')

%choose parameters
e = 0.25;
d = 0.5;
theta = 1;
T = 100;
%%%%%%%%%%%%%%%%%%

sA_bound = [
    0, 0, 0, 1, 1, 0, 0, 0, 1, 0;
    0, 0, 1, 0, 0, 1, 0, 0, 0, 1;
    0, 1, 0, 0, 0, 0, 1, 0, 0, 1;
    1, 0, 0, 0, 0, 0, 0, 1, 1, 0;
    1, 0, 0, 0, 0, 0, 0, 1, 1, 0;
    0, 1, 0, 0, 0, 0, 1, 0, 0, 1;
    0, 0, 1, 0, 0, 1, 0, 0, 0, 1;
    0, 0, 0, 1, 1, 0, 0, 0, 1, 0;
    0, 1, 1, 0, 0, 1, 1, 0, 0, 0;
    1, 0, 0, 1, 1, 0, 0, 1, 0, 0;
];
sA_pace = [
    0, 1, 0, 0, 1, 0, 0, 0, 0, 1;
    1, 0, 0, 0, 0, 1, 0, 0, 0, 1;
    0, 0, 0, 1, 0, 0, 1, 0, 1, 0;
    0, 0, 1, 0, 0, 0, 0, 1, 1, 0;
    1, 0, 0, 0, 0, 1, 0, 0, 0, 1;
    0, 1, 0, 0, 1, 0, 0, 0, 0, 1;
    0, 0, 1, 0, 0, 0, 0, 1, 1, 0;
    0, 0, 0, 1, 0, 0, 1, 0, 1, 0;
    1, 1, 0, 0, 1, 1, 0, 0, 0, 0;
    0, 0, 1, 1, 0, 0, 1, 1, 0, 0;
];
sA_trot = [
    0, 0, 0, 0, 1, 0, 1, 0, 1, 0;
    0, 0, 0, 0, 0, 1, 0, 1, 0, 1;
    0, 0, 0, 0, 1, 0, 1, 0, 1, 0;
    0, 0, 0, 0, 0, 1, 0, 1, 0, 1;
    1, 0, 1, 0, 0, 0, 0, 0, 1, 0;
    0, 1, 0, 1, 0, 0, 0, 0, 0, 1;
    1, 0, 1, 0, 0, 0, 0, 0, 1, 0;
    0, 1, 0, 1, 0, 0, 0, 0, 0, 1;
    0, 1, 0, 1, 0, 1, 0, 1, 0, 0;
    1, 0, 1, 0, 1, 0, 1, 0, 0, 0;
];
sA_walk = [
    0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1;
    0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0;
    0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0;
    1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1;
    0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0;
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0;
    0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0;
    1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;
    0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
    0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0;
    0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0;
    1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;
    0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0;
    0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0;
];
sA_pronk = [
    0, 1, 0, 1, 0, 1;
    1, 0, 1, 0, 0, 1;
    0, 1, 0, 1, 0, 1;
    1, 0, 1, 0, 0, 1;
    1, 1, 1, 1, 0, 0;
    0, 0, 0, 0, 1, 0;
];

sA_matrices = {sA_bound,sA_pace,sA_trot,sA_walk,sA_pronk};
names = {'bound','pace','trot','walk','pronk'};

on_neuron = [9,9,9,13,5];

leg_colors = [153,103,50;...%1
    203,33,40;...%2
    18,128,178;...%3
    42,153,71]/255;%4


%solve and plot
for i = 1:length(sA_matrices)

    n = length(sA_matrices{i});
    X0 = zeros(n,1);
    X0(on_neuron(i)) = 0.1; % neuron to turn on

    %solve ode
    soln = sA2soln(sA_matrices{i},T,X0,e,d,theta);

    figure(i)    
    %greyscale
    subplot(2,11,1:10);
    plot_grayscale(soln.X);
    title(names{i})
    yticks(1:n)

    subplot(2,11,11); imagesc(X0); title('init.')
    xticks([])

    %ratecurves
    subplot(2,11,12:21);
    plot_ratecurves(soln.X(:,1:4),soln.time,leg_colors);
    xlim([0,sum(T)])
    ylim([0,0.45])

    subplot(2,11,22); plot_colors(leg_colors);
    yticklabels({'LB','LF','RF','RB'})

end
